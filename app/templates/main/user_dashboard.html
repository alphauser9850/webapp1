{% extends "base.html" %}

{% block title %}My Dashboard{% endblock %}

{% block content %}
<<<<<<< HEAD
<div class="container py-4">
    <!-- User Info Section -->
    <div class="row mb-4">
        <div class="col-md-12">
            <div class="card shadow-sm">
                <div class="card-body">
                    <div class="row align-items-center">
                        <div class="col-md-8">
                            <h4 class="mb-0">Welcome, {{ current_user.username }}!</h4>
                            <p class="text-muted mb-0">{{ current_user.email }}</p>
                        </div>
                        <div class="col-md-4 text-end">
                            <h5 class="mb-0">
                                Remaining Hours: 
                                <span class="badge {% if current_user.remaining_hours > 0 %}bg-success{% else %}bg-danger{% endif %}">
                                    {{ current_user.formatted_remaining_time }}
                                </span>
                            </h5>
                        </div>
                    </div>
=======
<div class="min-h-screen bg-[#0A192F] text-[#E6F1FF] p-8">
    <!-- User Info Section -->
    <div class="bg-[#1B2B3A]/80 backdrop-blur-sm rounded-xl border border-[#2D4A5D] p-6 mb-8">
        <div class="flex flex-col md:flex-row justify-between items-center">
            <div>
                <h2 class="text-2xl font-semibold mb-2">Welcome, {{ current_user.username }}!</h2>
                <p class="text-[#8892B0]">{{ current_user.email }}</p>
            </div>
            <div class="mt-4 md:mt-0">
                <div class="flex items-center space-x-2">
                    <span class="text-[#8892B0]">Remaining Hours:</span>
                    <span class="px-3 py-1 rounded-full {% if current_user.remaining_hours > 0 %}bg-green-500/10 text-green-400{% else %}bg-red-500/10 text-red-400{% endif %}">
                        {{ current_user.formatted_remaining_time }}
                    </span>
>>>>>>> master
                </div>
            </div>
        </div>
    </div>

    <!-- Active Session Alert -->
    {% if active_session %}
<<<<<<< HEAD
    <div class="row mb-4">
        <div class="col-md-12">
            <div class="alert alert-info">
                <div class="d-flex justify-content-between align-items-center">
                    <div>
                        <h5 class="mb-1">Active Lab Session</h5>
                        <p class="mb-0">Started at {{ active_session.start_time.strftime('%Y-%m-%d %H:%M') }}</p>
                        <h3 class="mt-2 mb-0" id="countdown-timer">--:--:--</h3>
                        <small class="text-muted">Time Remaining</small>
                    </div>
                    <div class="text-end">
                        <a href="{{ url_for('main.lab_session', id=active_session.id) }}" class="btn btn-primary btn-lg">
                            Return to Lab <i class="fas fa-arrow-right ms-2"></i>
                        </a>
                    </div>
                </div>
=======
    <div class="bg-[#1B2B3A]/80 backdrop-blur-sm rounded-xl border border-[#2D4A5D] p-6 mb-8">
        <div class="flex flex-col md:flex-row justify-between items-center">
            <div>
                <h3 class="text-xl font-semibold mb-2">Active Lab Session</h3>
                <p class="text-[#8892B0] mb-2">Started at {{ active_session.start_time.strftime('%Y-%m-%d %H:%M') }}</p>
                <div class="font-mono text-2xl text-[#64FFDA]" id="countdown-timer">--:--:--</div>
                <span class="text-[#8892B0] text-sm">Time Remaining</span>
            </div>
            <div class="mt-4 md:mt-0">
                <a href="{{ url_for('main.lab_session', id=active_session.id) }}" 
                   class="inline-flex items-center px-6 py-3 bg-[#64FFDA] text-[#0A192F] rounded-lg hover:bg-[#64FFDA]/90 transition-colors">
                    Return to Lab
                    <i class="fas fa-arrow-right ml-2"></i>
                </a>
>>>>>>> master
            </div>
        </div>
    </div>
    {% endif %}

    <!-- Lab Categories -->
<<<<<<< HEAD
    <div class="row mb-4">
        <div class="col-md-12">
            <div class="d-flex justify-content-between align-items-center mb-3">
                <h4 class="mb-0">Available Lab Categories</h4>
                {% if current_user.remaining_hours == 0 %}
                <span class="badge bg-warning text-dark">Demo Mode Available</span>
                {% endif %}
            </div>
        </div>
    </div>

    <div class="row g-4">
        {% if categories %}
            {% for category in categories %}
            <div class="col-md-4">
                <div class="card h-100 shadow-sm hover-shadow">
                    <div class="card-body">
                        <div class="d-flex justify-content-between align-items-start mb-2">
                            <h5 class="card-title mb-0">{{ category.name }}</h5>
                            <span class="badge bg-info">Level: {{ category.level }}</span>
                        </div>
                        <p class="card-text text-muted">{{ category.description }}</p>
                        <div class="mt-3">
                            {% set active_servers = category.servers|selectattr('is_active', 'eq', true)|list %}
                            <span class="badge bg-success">
                                <i class="fas fa-server me-1"></i>
                                {{ active_servers|length }} Active Server{{ 's' if active_servers|length != 1 }}
                            </span>
                        </div>
                    </div>
                    <div class="card-footer bg-transparent">
                        <div class="d-flex justify-content-between align-items-center">
                            <a href="{{ url_for('main.category_servers', id=category.id) }}" class="btn btn-primary">
                                <i class="fas fa-server me-2"></i>View Labs
                            </a>
                        </div>
                    </div>
                </div>
            </div>
            {% endfor %}
        {% else %}
            <div class="col-12">
                <div class="card bg-light">
                    <div class="card-body text-center py-5">
                        <i class="fas fa-server fa-3x text-muted mb-3"></i>
                        <h5>No Lab Categories Available</h5>
                        <p class="text-muted mb-0">There are currently no lab categories with active servers. Please check back later or contact an administrator.</p>
                    </div>
                </div>
            </div>
        {% endif %}
=======
    <div class="mb-8">
        <h3 class="text-xl font-semibold mb-6">Available Lab Categories</h3>
        
        <!-- Category Tabs -->
        <div class="mb-6 overflow-x-auto">
            <nav class="flex space-x-4" role="tablist">
                <button class="px-4 py-2 text-[#64FFDA] border-b-2 border-[#64FFDA]" role="tab" aria-selected="true">
                    <i class="fas fa-star mr-2"></i>My Labs
                </button>
                {% for track in ['CCNA', 'Enterprise', 'Security', 'Data Center', 'Collaboration', 'Other'] %}
                <button class="px-4 py-2 text-[#8892B0] hover:text-[#64FFDA] border-b-2 border-transparent hover:border-[#64FFDA]/50 transition-colors" role="tab">
                    <i class="fas fa-{{ track_icons[track] }} mr-2"></i>{{ track }}
                </button>
                {% endfor %}
            </nav>
        </div>

        <!-- Category Grid -->
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
            {% for category in categories %}
            <div class="bg-[#1B2B3A]/80 backdrop-blur-sm rounded-xl border border-[#2D4A5D] p-6 hover:transform hover:-translate-y-1 transition-all duration-300">
                <div class="flex items-center justify-between mb-4">
                    <h4 class="text-lg font-medium">{{ category.name }}</h4>
                    <span class="px-2 py-1 text-xs rounded-full bg-blue-500/10 text-blue-400">
                        {{ category.servers|length }} servers
                    </span>
                </div>
                <p class="text-[#8892B0] mb-4">{{ category.description }}</p>
                <div class="flex justify-end">
                    <a href="{{ url_for('main.category_servers', id=category.id) }}"
                       class="inline-flex items-center px-4 py-2 bg-[#64FFDA] text-[#0A192F] rounded-lg hover:bg-[#64FFDA]/90 transition-colors">
                        View Labs
                        <i class="fas fa-arrow-right ml-2"></i>
                    </a>
                </div>
            </div>
            {% endfor %}
        </div>
>>>>>>> master
    </div>

    <!-- No Hours Warning -->
    {% if current_user.remaining_hours == 0 %}
<<<<<<< HEAD
    <div class="row mt-4">
        <div class="col-md-12">
            <div class="card bg-light">
                <div class="card-body">
                    <div class="d-flex align-items-center">
                        <i class="fas fa-info-circle text-warning me-3 fa-2x"></i>
                        <div>
                            <h5 class="mb-1">No Lab Hours Available</h5>
                            <p class="mb-0">You currently have no remaining hours. You can try the demo mode for each category or contact an administrator to get more lab hours.</p>
                        </div>
                    </div>
                </div>
=======
    <div class="bg-[#1B2B3A]/80 backdrop-blur-sm rounded-xl border border-[#2D4A5D] p-6">
        <div class="flex items-start space-x-4">
            <i class="fas fa-info-circle text-[#64FFDA] text-2xl"></i>
            <div>
                <h4 class="text-lg font-medium mb-2">No Lab Hours Available</h4>
                <p class="text-[#8892B0]">You currently have no remaining hours. You can try the demo mode for each category or contact an administrator to get more lab hours.</p>
>>>>>>> master
            </div>
        </div>
    </div>
    {% endif %}
</div>
<<<<<<< HEAD

{% block scripts %}
<script src="{{ url_for('static', filename='js/timer.js') }}"></script>
<script type="text/javascript">
=======
{% endblock %}

{% block scripts %}
<script src="{{ url_for('static', filename='js/timer.js') }}"></script>
<script>
>>>>>>> master
document.addEventListener('DOMContentLoaded', function() {
    {% if active_session and (current_user.remaining_hours > 0 or active_session.is_demo) %}
    // Create and start the session timer
    const timer = new SessionTimer({
        startTime: "{{ active_session.start_time.strftime('%Y-%m-%d %H:%M:%S') }} UTC",
        durationHours: {% if active_session.is_demo %}1{% else %}{{ current_user.remaining_hours|float }}{% endif %},
        timerId: 'countdown-timer',
        onTimeUp: function() {
<<<<<<< HEAD
            // Redirect to dashboard when time is up
=======
>>>>>>> master
            window.location.href = "{{ url_for('main.user_dashboard') }}";
        }
    });
    
    timer.start();
    
<<<<<<< HEAD
    // Clean up when leaving page
=======
>>>>>>> master
    window.addEventListener('beforeunload', function() {
        timer.stop();
    });
    {% endif %}
});
</script>
<<<<<<< HEAD
{% endblock %}

{% block styles %}
<style>
.hover-shadow {
    transition: all 0.3s ease;
}
.hover-shadow:hover {
    transform: translateY(-5px);
    box-shadow: 0 .5rem 1rem rgba(0,0,0,.15)!important;
}
#countdown-timer {
    font-family: monospace;
    color: #0d6efd;
}
</style>
{% endblock %}
=======
>>>>>>> master
{% endblock %} 